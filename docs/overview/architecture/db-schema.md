# Database Schema (public)

Derived from the current Supabase `public` schema. Columns are listed as `name (type, nullable, default)`.

## badges
- id (bigint, NO, nextval('badges_id_seq'::regclass))
- code (text, NO)
- label (text, NO)
- description (text, YES)
- is_public (boolean, NO, true)
- created_at (timestamptz, NO, now())

## featured_placements
- id (uuid, NO, gen_random_uuid())
- tournament_id (uuid, YES)
- start_at (timestamptz, NO)
- end_at (timestamptz, NO)
- region (text, YES)
- notes (text, YES)
- created_at (timestamptz, NO, now())

## feedback
- id (uuid, NO, gen_random_uuid())
- created_at (timestamptz, NO, now())
- name (text, YES)
- email (text, YES)
- message (text, NO)
- type (text, YES)
- page_url (text, YES)
- source (text, YES)
- status (text, YES, 'new'::text)
- meta (jsonb, YES)

## gear_items
- id (uuid, NO, gen_random_uuid())
- sport (text, NO)
- category (text, NO)
- name (text, NO)
- description (text, YES)
- amazon_url (text, YES)
- active (boolean, NO, true)
- created_at (timestamptz, NO, timezone('utc', now()))
- updated_at (timestamptz, NO, timezone('utc', now()))

## profiles
- user_id (uuid, NO)
- email (text, YES)
- real_name (text, YES)
- handle (text, NO)
- role (text, YES)
- state (text, YES)
- city (text, YES)
- is_admin (boolean, NO, false)
- created_at (timestamptz, NO, now())
- updated_at (timestamptz, NO, now())
- handle_changed_at (timestamptz, YES)
- years_refereeing (integer, YES)
- sports (ARRAY, YES)
- is_referee_verified (boolean, NO, false)
- email_opt_in_tournaments (boolean, NO, true)
- email_opt_in_marketing (boolean, NO, false)
- referrer_user_id (uuid, YES)

## referee_contacts
- id (uuid, NO, gen_random_uuid())
- name (text, YES)
- organization (text, YES)
- role (text, YES)
- email (text, YES)
- phone (text, YES)
- state (text, YES)
- city (text, YES)
- zip (text, YES)
- notes (text, YES)
- source_url (text, YES)
- created_at (timestamptz, YES, now())
- updated_at (timestamptz, YES, now())
- type (text, NO, 'general'::text)
- status (text, NO, 'pending'::text)
- confidence (numeric, YES)

## referee_verification_requests
- id (bigint, NO, nextval('referee_verification_requests_id_seq'::regclass))
- user_id (uuid, NO)
- association (text, YES)
- level (text, YES)
- notes (text, YES)
- evidence_url (text, YES)
- status (text, NO, 'pending'::text)
- submitted_at (timestamptz, NO, now())
- reviewed_at (timestamptz, YES)
- reviewed_by (uuid, YES)
- admin_notes (text, YES)

## referral_codes
- user_id (uuid, NO)
- code (text, NO)
- created_at (timestamptz, NO, now())

## review_invites
- id (uuid, NO, gen_random_uuid())
- created_at (timestamptz, NO, now())
- referee_email (text, NO)
- referee_name (text, YES)
- tournament_slug (text, YES)
- tournament_id (uuid, YES)
- note (text, YES)
- source_url (text, YES)
- source_user_id (uuid, YES)
- source_email (text, YES)
- status (text, NO, 'pending'::text)
- sent_at (timestamptz, YES)

## school_referee_reviews
- id (uuid, NO, gen_random_uuid())
- school_id (uuid, YES)
- user_id (uuid, YES)
- created_at (timestamptz, YES, now())
- overall_score (smallint, NO)
- logistics_score (smallint, NO)
- facilities_score (smallint, NO)
- pay_score (smallint, NO)
- support_score (smallint, NO)
- worked_games (smallint, YES)
- shift_detail (text, YES)
- status (text, NO, 'pending'::text)
- sport (text, NO, 'soccer'::text)

## school_referee_reviews_public
- id (uuid, YES)
- school_id (uuid, YES)
- created_at (timestamptz, YES)
- sport (text, YES)
- overall_score (smallint, YES)
- logistics_score (smallint, YES)
- facilities_score (smallint, YES)
- pay_score (smallint, YES)
- support_score (smallint, YES)
- worked_games (smallint, YES)
- shift_detail (text, YES)
- school_name (text, YES)
- school_city (text, YES)
- school_state (text, YES)
- reviewer_handle (text, YES)
- reviewer_level (integer, YES)

## school_referee_scores
- school_id (uuid, NO)
- ai_score (numeric, YES)
- review_count (integer, YES, 0)
- summary (text, YES)
- status (text, YES, 'clear'::text)
- updated_at (timestamptz, YES, now())

## schools
- id (uuid, NO, gen_random_uuid())
- name (text, NO)
- city (text, NO)
- state (text, NO)
- address (text, YES)
- slug (text, NO)
- google_place_id (text, YES)
- latitude (double precision, YES)
- longitude (double precision, YES)
- zip (text, YES)
- created_at (timestamptz, YES, now())

## tournament_contacts
- id (uuid, NO, gen_random_uuid())
- tournament_id (uuid, YES)
- type (text, YES, 'general'::text)
- name (text, YES)
- email (text, YES)
- phone (text, YES)
- source_url (text, YES)
- confidence (smallint, YES)
- status (text, YES, 'pending'::text)
- notes (text, YES)
- created_at (timestamptz, YES, now())
- updated_at (timestamptz, YES, now())

## tournament_corrections
- id (uuid, NO, gen_random_uuid())
- tournament_id (uuid, YES)
- reporter_email (text, YES)
- message (text, NO)
- proposed_changes (jsonb, YES)
- status (text, NO, 'new'::text)
- created_at (timestamptz, NO, now())

## tournament_referee_contacts
- id (uuid, NO, gen_random_uuid())
- tournament_id (uuid, NO)
- referee_contact_id (uuid, NO)
- notes (text, YES)
- created_at (timestamptz, NO, timezone('utc', now()))

## tournament_referee_reviews
- id (uuid, NO, gen_random_uuid())
- created_at (timestamptz, NO, now())
- tournament_id (uuid, NO)
- user_id (uuid, NO)
- overall_score (smallint, NO)
- logistics_score (smallint, NO)
- facilities_score (smallint, NO)
- pay_score (smallint, NO)
- support_score (smallint, NO)
- worked_games (smallint, YES)
- shift_detail (text, YES)
- status (text, NO, 'pending'::text)
- moderator_notes (text, YES)

## tournament_referee_reviews_public
- id (uuid, YES)
- tournament_id (uuid, YES)
- created_at (timestamptz, YES)
- reviewer_handle (text, YES)
- reviewer_level (text, YES)
- worked_games (smallint, YES)
- overall_score (smallint, YES)
- logistics_score (smallint, YES)
- facilities_score (smallint, YES)
- pay_score (smallint, YES)
- support_score (smallint, YES)
- shift_detail (text, YES)

## tournament_referee_scores
- tournament_id (uuid, NO)
- ai_score (numeric, YES)
- review_count (integer, NO, 0)
- summary (text, YES)
- status (text, NO, 'clear'::text)
- updated_at (timestamptz, NO, now())

## tournament_sources
- id (uuid, NO, gen_random_uuid())
- tournament_id (uuid, YES)
- url (text, NO)
- domain (text, YES)
- title (text, YES)
- fetched_at (timestamptz, NO, now())
- http_status (integer, YES)
- content_hash (text, YES)
- extracted_json (jsonb, YES)
- extract_confidence (smallint, YES, 50)
- created_at (timestamptz, NO, now())

## tournaments
- id (uuid, NO, gen_random_uuid())
- name (text, NO)
- slug (text, NO)
- sport (text, NO)
- level (text, YES)
- state (text, NO)
- city (text, YES)
- zip (text, YES)
- venue (text, YES)
- address (text, YES)
- start_date (date, YES)
- end_date (date, YES)
- source_url (text, NO)
- source_domain (text, YES)
- source_title (text, YES)
- source_last_seen_at (timestamptz, YES)
- summary (text, YES)
- notes (text, YES)
- status (text, NO, 'published'::text)
- confidence (smallint, NO, 50)
- canonical_tournament_id (uuid, YES)
- is_canonical (boolean, NO, true)
- created_at (timestamptz, NO, now())
- updated_at (timestamptz, NO, now())
- last_seen_at (timestamptz, YES)
- referee_pay (text, YES)
- referee_contact (text, YES)
- sub_type (text, YES, 'internet'::text)
- cash_tournament (boolean, YES, false)
- source (text, YES)
- source_event_id (text, YES)

## user_badges
- user_id (uuid, NO)
- badge_id (bigint, NO)
- status (text, NO, 'earned'::text)
- awarded_at (timestamptz, NO, now())
- awarded_by (uuid, YES)
- notes (text, YES)

## purchases
- id (uuid, NO, gen_random_uuid())
- user_id (uuid, NO)
- tournament_id (uuid, NO)
- product (text, NO)
- sku (text, NO)
- status (text, NO, 'paid'::text)
- stripe_customer_id (text, YES)
- stripe_payment_intent_id (text, YES)
- amount_cents (integer, NO)
- currency (text, NO, 'usd'::text)
- created_at (timestamptz, NO, now())

## subscriptions
- id (uuid, NO, gen_random_uuid())
- user_id (uuid, NO)
- product (text, NO)
- plan (text, NO)
- status (text, NO, 'active'::text)
- stripe_customer_id (text, YES)
- stripe_subscription_id (text, YES)
- current_period_start (timestamptz, YES)
- current_period_end (timestamptz, YES)
- cancel_at_period_end (boolean, NO, false)
- created_at (timestamptz, NO, now())
- updated_at (timestamptz, NO, now())

## venues
- id (uuid, NO, gen_random_uuid())
- name (text, NO)
- address1 (text, YES)
- address2 (text, YES)
- city (text, YES)
- state (text, YES)
- zip (text, YES)
- latitude (double precision, YES)
- longitude (double precision, YES)
- amenities (jsonb, YES)
- notes (text, YES)
- created_at (timestamptz, NO, now())
- updated_at (timestamptz, NO, now())
